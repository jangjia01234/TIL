## Database

### 강종범 멘토님 (BE)

<br>

- 데이터베이스 모델링
- 백엔드뿐만 아니라 프론트엔드 역시 관계형 데이터베이스의 정의, 데이터베이스의 테이블 구조 등을 알면 문제 해결이 훨씬 수월해지고 아키텍쳐 구성에도 도움이 된다

<br>

## 목차

1. 데이터베이스란?
2. 데이터베이스를 사용하는 이유
3. 관계형 데이터베이스 (RDBMS)

<br><br>

## 세션

1. 데이터베이스란?

- 데이터: 수, 단어, 이미지, 영상 등의 형태로 된 의미 단위
- 웹 생태계에서 클라이언트란 프론트엔드 서버를 말함
- 웹 클라에서 DB로 정보를 요청하고 받는 과정에서 중간에 웹 어플리케이션 서버를 반드시 거쳐야 하는 이유는 보안 때문
- 웹 클라이언트의 구조(flow)
  - -> 확인하고자 하는 항목 클릭
    <br>
    -> 클라이언트(브라우저, 웹 서버)가 웹 어플리케이션 서버(백엔드 서버)에 상품 상세 정보 요청
    <br>
    -> 웹 어플리케이션 서버가 데이터베이스에 필요한 정보 요청
    <br>
    -> DB가 필요한 정보를 웹 어플리케이션 서버로 응답
    <br>
    -> 웹 어플리케이션 서버가 웹 클라이언트에 상품 상세 정보 응답

<br>

- 데이터베이스: 컴퓨터 시스템에 저장된 정보나 데이터를 모두 모아 놓은 집합
- 데이터들은 DBMS(Database Management System)로 제어 및 관리

<br><br>

2. 데이터베이스를 사용하는 이유

- 데이터베이스가 아니라 (어플리케이션) 서버에 데이터를 저장하면 안될까?
  <br>
  -> 서버에서도 저장할 수 있지만, DBMS만큼 효율적으로 관리하기가 쉽지 않음 (일관성, 안정성 문제)
  <br>
  -> 각 서버가 데이터를 모두 가지고 있다면 서버마다 다른 데이터를 가지게 되어 문제가 생길 수 있음 (데이터는 여러 서비스에 걸쳐 사용되는 경우가 많기 때문)
  <br>
  -> 데이터를 한 곳에 저장하여 일관되게 관리하는 것이 중요

  <br>

- 데이터를 체계적으로 보관 및 관리해야 원하는 정보를 쉽게 가져올 수 있음

<br><br>

3. 관계형 데이터베이스(RDBMS)

- 관계형 데이터베이스란?
  - RDBMS(Relational Database Management System)
  - 관계형 데이터 모델에 기초를 둔 데이터베이스 시스템
  - 관계형 데이터: 데이터를 서로 상호 관련성을 가진 형태로 표현한 것
  - 종류: MySQL, PostgreSQL, Oracle, MSSQL ..
  - 특징:
    - 모든 데이터는 2차원 테이블(Table)로 표현할 수 있음
      <br>
      -> 책 테이블(My books) 예시
    - 테이블의 각 행(row)은 자신만의 고유 키(Primary key, PK)가 있음
      <br>
      -> PK를 통해 특정 row 검색/참조 가능
    - 각각의 테이블은 서로 상호 관련성을 가지고 연결될 수 있음
      <br>
      -> 면접자-면접관 예시 (대부분 Many to Many 관계)
      - 일대일 관계(One to One)
        - ex.주민등록번호 - 사람당 1개뿐
        - PK - FK(Foreign Key, 외래 키) 연결
        - 다른 테이블의 PK 값(사람 이름)을 가져와서 FK(주민번호)로 지정 가능
        - 컬럼이 너무 많아질 때 / 확장성을 이유로 분리하여 사용
        - 주민번호 테이블의 user_id 컬럼은 users 테이블의 id(pk)를 참조한다
      - 일대다 관계(One to Many)
        - ex. 한 명의 주인이 여러 마리의 펫을 키우는 경우
        - 한 펫이 여러 명의 주인을 가지는 반대의 경우는 불가
        - Pets 테이블의 user_id 컬럼은 users 테이블의 id(pk)를 참조한다
        - 이때 pets에 참조한 users는 그 자체로는 pk이고, 참조된 user_id는 (한 항목에 여러 키를 입력하므로) 고유하지 않은 Foreign key 이다
      - 다대다 관계(Many to Many)
        - ex. Books 테이블 -> 한 작가는 여러 권의 책을 쓸 수 있고, 한 책에도 작가는 여러 명(공동 저자)이 될 수 있음
        - ex. 영화와 영화배우 -> 한 영화에 여러 배우가 출연하고, 한 배우가 여러 영화에 출연함
        - 여러 작가와 여러 책을 겹치지 않게 테이블을 분리해 다 나눠서 작성하는 것
          <br> -> 정규화(Normalization)
          <br> -> 프론트엔드의 경우에도 복잡한 데이터를 봤을 때 정규화가 필요하다는 것을 판단할 수 있어야 함
        - 서로 다른 테이블의 여러 데이터와 연결될 때는 두 테이블에 속한 데이터의 조합을 입력하기 위한 **중간 테이블**이 생성됨
          - 저자 테이블의 id, 책 테이블의 id를 연관지어 작성한 중간테이블 author_books 필요 (다른 테이블의 고유한 식별 키 참조)

<br><br>

## 과제

- 스타벅스 모델링 과제 ([westudy 링크](https://study.wecode.co.kr/session/23) 참고)
- 구조 그리는 것을 ERD라고 부르는데, db.diagram을 활용해서 ERD를 그려야 함

<br><br>

## 과제 리뷰

- 개발자의 역량은 암기가 아니라 빠른 습득력이다. 외우는 것보다 빠르게 이해하는 것이 중요함. 같은 내용을 봤을 때 아는 내용을 잘 떠올리고, 모르겠을 때는 잘 검색하는 역량을 기를 것
- 당장에 이해가 안되는 것을 오래 붙잡고 있기보다는 빠르게 이해하고 넘어갈 것
- 잘하더라도 늘 겸손하고, 못해도 높은 자존감을 유지하기
- 개발자는 남이 편하기 위해 내가 불편한 직업

<br>

- 기본 이론
  - ERD(Entity Relationship Diagram)는 모델링의 기초 청사진
  - 나 혼자만의 것 ❌ 모두의 것 ⭕️. ERD 설계는 너무나 중요해서 주니어가 진행할 가능성이 매우 낮음
  - 데이터베이스에 그대로 복붙 가능한 수준으로 만들어야 함
  - 정규화의 여부? 어려운 것이 당연. 정규화를 많이 하는 게 무조건 좋은 게 아니라 적당히 해야 함
  - DB 설계는 케바케
  - 마주한 상황에서 최적화된 방법을 찾는 것이 중요
  - ERD는 데이터가 들어가는 것이 아니라 데이터 테이블의 로우 값이 세로로 들어가는 것 기억하기 (엑셀 시트 예시)
  - ERD는 작성에서 끝나는 게 아니라 추후 새로운 비즈니스에서도 활용될 수 있음

- 피드백
  - **어떤 상황에서도 절대 영어 약어를 사용하지 말 것**
  - 모든 테이블명은 **소문자 복수형**으로 작성할 것
  - 다대다 테이블에 **중간 테이블** 필수
  - 신상품 정보는 카테고리 안에 신상품 카테고리가 존재해서 음료로 연결하면 됨, varchar가 아니라 boolean(true/false)로 설정
  - 영양 정보는 정수로 정확히 떨어지지 않으므로 int보다는 **소수점 단위**로 기록하는 것이 더 좋음 (float)
  - 영양 정보의 **단위**도 함께 기재했다면 더 좋았을듯
  - 1:1 관계인 description은 별도 테이블로 빼지 않고 beverage 테이블의 항목으로 추가하는 것이 더 효율적
  - 만약 1:1 데이터가 변하는 경우 (ex. 매주 사진을 변경하는 경우) 에는 따로 테이블을 빼는 것이 좋다
  - 중간 테이블은 칼럼이 최소 두 개 있어야 한다. ex. drink - allergy 연결할 경우 drink_id 와 allergy_id 항목이 반드시 존재해야 함
  - 명칭을 원어로 잘 작성하는 것도 중요하다 (ex. salt -> solium)
  - nutrition 값은 decimal 로 작성하는 것이 좋음
  - 네이밍 영어로 통일, snake case 사용할 것

<br>

- 우리 팀 피드백
<img width="643" alt="스크린샷 2023-02-15 오후 12 03 41" src="https://user-images.githubusercontent.com/71865277/218916524-ca518d12-4600-4619-b6ea-f2a81b36d3f8.png">
  - 카테고리와 메뉴가 반대로 작성되어 있음 (메뉴 -> 카테고리 순서)
  - 과도하게 정규화 되어있음
  - 테이블명 명사 복수형이 되어야 함
  - milk, egg 등을 int가 아닌 varchar로 설정하면 단위를 따로 설정하지 않고 테이블에 값 자체로 들어가게 됨 (ex. milk - 10ml)
  - -> 이 경우 milk와 egg가 데이터로 들어가야 하는데 칼럼으로 들어감
  - 다대다의 경우 중간 테이블이 잘 생성되어 있음
  - 음료와 영양정보가 다대다로 연결된 점은 과도한 정규화. 중간 테이블 없이 beverage - nutrition 이 1:1의 관계로 작성되거나 nutrition이 be 겨verage 안에 들어가도 됨
  - new의 경우 boolean으로 작성해야 함 (true, false varchar로 쓰지 말 것)
  - img 테이블 네이밍은 beverage_img 로 수정해야 알아보기 더 쉬움

<br><br>

- 모범 답안
<img width="1071" alt="스크린샷 2023-02-15 오후 12 10 01" src="https://user-images.githubusercontent.com/71865277/218917413-38a5607f-ac4e-4d2f-b35d-6a19b2729503.png">
